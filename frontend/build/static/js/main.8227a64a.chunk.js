(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{46:function(e,t,n){e.exports=n(77)},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(22),c=n.n(s),o=n(3),i=n(14),u=n(42),l=n(17),h=function(e){return{loggedIn:e.session.isAuthenticated}},p=Object(l.g)(Object(o.b)(h)((function(e){var t=e.component,n=e.path,r=e.loggedIn,s=e.exact;return a.a.createElement(l.b,{path:n,exact:s,render:function(e){return r?a.a.createElement(l.a,{to:"/portfolio"}):a.a.createElement(t,e)}})}))),m=Object(l.g)(Object(o.b)(h)((function(e){var t=e.component,n=e.loggedIn,r=Object(u.a)(e,["component","loggedIn"]);return a.a.createElement(l.b,Object.assign({},r,{render:function(e){return n?a.a.createElement(t,e):a.a.createElement(l.a,{to:"/login"})}}))}))),d=n(12),f=n.n(d),E=function(e){e?f.a.defaults.headers.common.Authorization=e:delete f.a.defaults.headers.common.Authorization},b=n(24),v=n.n(b),y=function(e){return{type:"RECEIVE_SESSION_ERRORS",errors:e}},g=function(e){return function(t){return(n=e,f.a.post("/api/users/register",n)).then((function(){return t({type:"RECEIVE_USER_SIGN_IN"})}),(function(e){return t(y(e.response.data))}));var n}},S=function(e){return function(t){return(n=e,f.a.post("/api/users/login",n)).then((function(e){var n=e.data.token;localStorage.setItem("jwtToken",n),E(n);var r=v()(n);t({type:"RECEIVE_CURRENT_USER",currentUser:r})})).catch((function(e){t(y(e.response.data))}));var n}},O=function(){return function(e){localStorage.removeItem("jwtToken"),E(!1),e({type:"RECEIVE_USER_LOGOUT"})}},k=n(5),j=n(6),C=n(8),N=n(7),R=n(2),P=n(9),I=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(N.a)(t).call(this,e))).logoutUser=n.logoutUser.bind(Object(R.a)(n)),n.getLinks=n.getLinks.bind(Object(R.a)(n)),n}return Object(P.a)(t,e),Object(j.a)(t,[{key:"logoutUser",value:function(e){e.preventDefault(),this.props.logout()}},{key:"getLinks",value:function(){return this.props.loggedIn?a.a.createElement("div",{className:"nav-container"},a.a.createElement(i.b,{className:"links",to:"/portfolio"},"Portfolio"),a.a.createElement(i.b,{className:"links",to:"/transactions"},"Transactions"),a.a.createElement("button",{onClick:this.logoutUser},"Logout")):a.a.createElement("div",{className:"splash-nav-container"},a.a.createElement(i.b,{className:"links",to:"/signup"},"Signup"),a.a.createElement(i.b,{className:"links",to:"/login"},"Login"))}},{key:"render",value:function(){return a.a.createElement("div",{className:"header-container"},a.a.createElement("h1",{className:"header"},"TTP Full Stack"),this.getLinks())}}]),t}(a.a.Component),w=Object(o.b)((function(e){return{loggedIn:e.session.isAuthenticated}}),{logout:O})(I),_=function(e){function t(){return Object(k.a)(this,t),Object(C.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"splash-page-container"},a.a.createElement("h1",{className:"main-header"},"Welcome to Eugene Chung's TTP Second Stage Submission"),a.a.createElement("footer",{className:"main-footer"},"Copyright \xa9 2020 Chung"))}}]),t}(a.a.Component),T=n(19),B=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(N.a)(t).call(this,e))).state={email:"",password:"",errors:{}},n.handleSubmit=n.handleSubmit.bind(Object(R.a)(n)),n.renderErrors=n.renderErrors.bind(Object(R.a)(n)),n}return Object(P.a)(t,e),Object(j.a)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.currentUser&&this.props.history.push("/tweets"),this.setState({errors:e.errors})}},{key:"update",value:function(e){var t=this;return function(n){return t.setState(Object(T.a)({},e,n.currentTarget.value))}}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,password:this.state.password};this.props.login(t)}},{key:"renderErrors",value:function(){var e=this;return a.a.createElement("ul",null,Object.keys(this.state.errors).map((function(t,n){return a.a.createElement("li",{key:"error-".concat(n)},e.state.errors[t])})))}},{key:"render",value:function(){return a.a.createElement("div",{className:"signin-form-container"},a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",null,a.a.createElement("input",{type:"text",value:this.state.email,onChange:this.update("email"),placeholder:"Email"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password,onChange:this.update("password"),placeholder:"Password"}),a.a.createElement("br",null),a.a.createElement("input",{className:"submit-button",type:"submit",value:"Submit"}),this.renderErrors())))}}]),t}(a.a.Component),L=Object(l.g)(B),U=Object(o.b)((function(e){return{errors:e.errors.session}}),(function(e){return{login:function(t){return e(S(t))}}}))(L),V=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(N.a)(t).call(this,e))).state={email:"",name:"",password:"",password2:"",errors:{}},n.handleSubmit=n.handleSubmit.bind(Object(R.a)(n)),n}return Object(P.a)(t,e),Object(j.a)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.signedIn&&this.props.history.push("/login"),this.setState({errors:e.errors})}},{key:"update",value:function(e){var t=this;return function(n){return t.setState(Object(T.a)({},e,n.currentTarget.value))}}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,name:this.state.name,password:this.state.password,password2:this.state.password2};this.props.signup(t,this.props.history)}},{key:"renderErrors",value:function(){var e=this;return a.a.createElement("ul",null,Object.keys(this.state.errors).map((function(t,n){return a.a.createElement("li",{key:"error-".concat(n)},e.state.errors[t])})))}},{key:"render",value:function(){return a.a.createElement("div",{className:"signup-form-container"},a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",{className:"signup-form"},a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.email,onChange:this.update("email"),placeholder:"Email"}),a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.name,onChange:this.update("name"),placeholder:"Name"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password,onChange:this.update("password"),placeholder:"Password"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password2,onChange:this.update("password2"),placeholder:"Confirm Password"}),a.a.createElement("br",null),a.a.createElement("input",{className:"submit-button",type:"submit",value:"Submit"}),this.renderErrors())))}}]),t}(a.a.Component),A=Object(l.g)(V),x=Object(o.b)((function(e){return{signedIn:e.session.isSignedIn,errors:e.errors.session}}),(function(e){return{signup:function(t){return e(g(t))}}}))(A),F=n(31),q=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(N.a)(t).call(this,e))).state={currentString:"",display:!1,currentStockSymbol:null,quantity:0},n.handleQuery=n.handleQuery.bind(Object(R.a)(n)),n.handleBlur=n.handleBlur.bind(Object(R.a)(n)),n.handleFocus=n.handleFocus.bind(Object(R.a)(n)),n.handleQuantity=n.handleQuantity.bind(Object(R.a)(n)),n}return Object(P.a)(t,e),Object(j.a)(t,[{key:"handleQuery",value:function(e){var t=this;this.setState({currentString:e.target.value},(function(){if(t.state.currentString&&t.state.currentString.length>1&&t.state.currentString.length%2===0)return t.props.searchStock(t.state.currentString)}))}},{key:"handleQuantity",value:function(e){this.setState({quantity:e.target.value})}},{key:"renderResults",value:function(){var e,t=this;""===this.state.currentString?e=a.a.createElement("div",{className:"no-results"}):e=Object.values(this.props.results).filter((function(e){if("United States"===e["4. region"])return e})).map((function(e,n){return a.a.createElement("li",{key:n,className:"filtered-search",onClick:function(){return t.setState({currentString:e["2. name"],currentStockSymbol:e["1. symbol"]})}},a.a.createElement("div",{className:"search-symbol"},e["1. symbol"]),a.a.createElement("span",{className:"search-name"},e["2. name"]))}));return e}},{key:"handleBlur",value:function(){var e=this;setTimeout((function(){e.state.display&&e.setState({display:!1})}),200)}},{key:"handleFocus",value:function(){this.state.display||this.setState({display:!0})}},{key:"render",value:function(){var e=this,t=this.renderResults(),n={symbol:this.state.currentStockSymbol,qty:this.state.quantity,balance:this.props.accountBalance,userId:this.props.userId};return a.a.createElement("div",{className:"search-container"},a.a.createElement("input",{type:"search",className:"search-bar",onBlur:this.handleBlur,onFocus:this.handleFocus,onChange:this.handleQuery,value:this.state.currentString,placeholder:"Search a Company"}),t.length>0&&a.a.createElement("div",{className:"search-results-".concat(this.state.display)},a.a.createElement("ul",{className:"search-list"},t)),a.a.createElement("input",{type:"text",onChange:this.handleQuantity,className:"quantity",placeholder:"Quantity"}),a.a.createElement("button",{onClick:function(){return e.props.purchaseStock(n)}},"Buy"))}}]),t}(a.a.Component),Q=function(e){return{type:"RECEIVE_NEW_BALANCE",accountBalance:e}},D=function(e){return function(t){return function(e){return f.a.get("api/stocks/fetchlatestPrice/".concat(e))}(e).then((function(e){return t(function(e){return{type:"RECEIVE_LATEST_PRICE",payload:e}}(e))}))}},M=function(e){return function(t){return function(e){var t=e.join(",");return f.a.get("api/stocks/fetchlatestBatchPrices/".concat(t))}(e).then((function(e){return t(function(e){return{type:"RECEIVE_LATEST_BATCH_PRICES",payload:e}}(e))}))}},z=function(e){return function(t){return function(e){return f.a.get("/api/users/balance/".concat(e))}(e).then((function(e){return t(Q(e))}))}},$=function(e){return function(t){return function(e){return f.a.get("/api/stocks/user/".concat(e))}(e).then((function(e){return t(function(e){return{type:"RECEIVE_PORTFOLIO",portfolio:e}}(e))}))}},H=function(e){return function(t){return(n=e,f.a.get("/api/stocks/search/".concat(n))).then((function(e){return t(function(e){return{type:"RECEIVE_SEARCH",results:e}}(e))}));var n}},W=function(e){return function(t){return(n=e,f.a.post("/api/stocks/purchaseStock",n)).then((function(e){return t(Q(e))}),(function(e){return t({type:"RECEIVE_PORTFOLIO_ERRORS",errors:e.response.data})}));var n}},G=Object(o.b)((function(e){return{results:e.entities.search,accountBalance:e.session.user.balance}}),(function(e){return{searchStock:function(t){return e(H(t))},purchaseStock:function(t){return e(W(t))}}}))(q),Y=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(N.a)(t).call(this,e))).state={currentBalance:0,portfolioValue:0,errors:{},symbols:new Set,quantities:{}},n.renderStockQuantities=n.renderStockQuantities.bind(Object(R.a)(n)),n.renderLatestStockPrices=n.renderLatestStockPrices.bind(Object(R.a)(n)),n.renderStockSymbols=n.renderStockSymbols.bind(Object(R.a)(n)),n.updatePortfolioValue=n.updatePortfolioValue.bind(Object(R.a)(n)),n.fetchLatestStockBatchPrices=n.fetchLatestStockBatchPrices.bind(Object(R.a)(n)),n}return Object(P.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.fetchAccountBalance(this.props.currentUser.id),this.setState({currentBalance:this.props.accountBalance}),this.props.fetchPortfolio(this.props.currentUser.id).then((function(){return e.fetchLatestStockBatchPrices()}))}},{key:"componentDidUpdate",value:function(){var e=this;this.props.accountBalance!==this.state.currentBalance?(this.setState({currentBalance:this.props.accountBalance}),this.props.fetchPortfolio(this.props.currentUser.id).then((function(){return e.fetchLatestStockBatchPrices()}))):this.props.errors!==this.state.errors&&this.setState({errors:this.props.errors})}},{key:"updatePortfolioValue",value:function(){var e=this.state.quantities,t=0;return this.props.prices.map((function(n,r){return t+=n.latestPrice*e[r]})),t}},{key:"renderErrors",value:function(){var e=this;return Object.keys(this.state.errors).map((function(t,n){return a.a.createElement("li",{key:"port-error-".concat(n)},e.state.errors[t])}))}},{key:"fetchLatestStockBatchPrices",value:function(){var e=Array.from(this.state.symbols);this.props.fetchStockBatchPrices(e)}},{key:"renderLatestStockPrices",value:function(){var e=this.state.quantities;return this.props.prices.map((function(t,n){return t.latestPrice>t.previousClose?a.a.createElement("div",{key:"price-".concat(n),className:"green-stock"},"$",(t.latestPrice*e[n]).toFixed(2)):t.latestPrice<t.previousClose?a.a.createElement("div",{key:"price-".concat(n),className:"red-stock"},"$",(t.latestPrice*e[n]).toFixed(2)):t.latestPrice===t.previousClose?a.a.createElement("div",{key:"price-".concat(n),className:"gray-stock"},"$",(t.latestPrice*e[n]).toFixed(2)):void 0}))}},{key:"renderStockSymbols",value:function(){var e=Array.from(this.state.symbols);return this.props.prices.map((function(t,n){return t.latestPrice>t.previousClose?a.a.createElement("div",{key:"symbol-".concat(n),className:"symbol-green"},e[n]):t.latestPrice<t.previousClose?a.a.createElement("div",{key:"symbol-".concat(n),className:"symbol-red"},e[n]):t.latestPrice===t.previousClose?a.a.createElement("div",{key:"symbol-".concat(n),className:"symbol-gray"},e[n]):void 0}))}},{key:"renderStockQuantities",value:function(){var e,t=this,n=this.props.portfolio.reduce((function(e,t){var n=e.get(t.symbol)||0;return e.set(t.symbol,t.quantity+n),e}),new Map);return 0===n.size?a.a.createElement("p",null,"Your portfolio is empty"):(e=Object(F.a)(n.values()).map((function(e,n){return t.state.quantities[n]=e,a.a.createElement("div",{key:"qty-".concat(n)},e," Share(s)")})),Object(F.a)(n.keys()).map((function(e){t.state.symbols.add(e)})),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"share-quantity"},e)))}},{key:"render",value:function(){return a.a.createElement("div",{className:"main-container"},a.a.createElement("div",{className:"portfolio-container"},a.a.createElement("div",{className:"portfolio-header-wrapper"},a.a.createElement("div",{className:"portfolio-value"},"Portfolio Value: $",this.updatePortfolioValue().toFixed(2)," ")),a.a.createElement("div",{className:"portfolio-items-wrapper"},a.a.createElement("ul",{className:"stock-index"},a.a.createElement("li",{className:"index-item"},a.a.createElement("div",{className:"company-symbol"},this.renderStockSymbols()),this.renderStockQuantities(),a.a.createElement("div",{className:"stock-price"},this.renderLatestStockPrices()))))),a.a.createElement("div",{className:"trading-container"},a.a.createElement("div",{className:"account-balance"},"Cash Available: $",this.state.currentBalance.toFixed(2)," "),a.a.createElement(G,{userId:this.props.currentUser.id}),this.renderErrors()))}}]),t}(r.Component),J=Object(o.b)((function(e){return{currentUser:e.session.user,accountBalance:e.session.user.balance,portfolio:e.entities.portfolio,prices:e.entities.prices,errors:e.errors.portfolio}}),(function(e){return{fetchPortfolio:function(t){return e($(t))},fetchAccountBalance:function(t){return e(z(t))},fetchStockPrice:function(t){return e(D(t))},fetchStockBatchPrices:function(t){return e(M(t))}}}))(Y),K=function(e){function t(){return Object(k.a)(this,t),Object(C.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPortfolio(this.props.currentUser.id)}},{key:"formatAMPM",value:function(e){var t=e.getHours(),n=e.getMinutes(),r=t>=12?"pm":"am";return" @ "+(t=(t%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+r}},{key:"formatDate",value:function(e){return e.toLocaleString().split(",")[0]}},{key:"renderTransactions",value:function(){var e=this;return this.props.transactions.map((function(t,n){var r=t.symbol,s=t.price,c=t.quantity,o=e.formatDate(new Date(t.date)).concat(e.formatAMPM(new Date(t.date)).toString());return a.a.createElement("li",{className:"index-item",key:n},a.a.createElement("div",null," BUY(",r,") "),a.a.createElement("div",null,c," Share(s) @"),a.a.createElement("div",null,"$",s),a.a.createElement("div",null,o))})).reverse()}},{key:"render",value:function(){return a.a.createElement("div",{className:"transaction-container"},a.a.createElement("div",{className:"transaction-title"},"Transactions"),a.a.createElement("ul",{className:"transaction-index"},0!==this.props.transactions.length?this.renderTransactions():a.a.createElement("div",null,"You have not made any transactions with your account.")))}}]),t}(r.Component),X=Object(o.b)((function(e){return{currentUser:e.session.user,transactions:e.entities.transactions}}),(function(e){return{fetchPortfolio:function(t){return e($(t))}}}))(K),Z=function(){return a.a.createElement("div",{className:"background"},a.a.createElement(w,null),a.a.createElement(l.d,null,a.a.createElement(p,{exact:!0,path:"/",component:_}),a.a.createElement(p,{exact:!0,path:"/login",component:U}),a.a.createElement(p,{exact:!0,path:"/signup",component:x})),a.a.createElement(m,{path:"/portfolio",component:J}),a.a.createElement(m,{path:"/transactions",component:X}))},ee=function(e){var t=e.store;return a.a.createElement(o.a,{store:t},a.a.createElement(i.a,null,a.a.createElement(Z,null)))},te=n(15),ne=n(44),re=n(45),ae=n.n(re),se=n(30),ce=n(25),oe={isAuthenticated:!1,user:{}},ie=[],ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_SESSION_ERRORS":return t.errors;case"RECEIVE_CURRENT_USER":return ie;default:return e}},le=[],he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_PORTFOLIO_ERRORS":return t.errors;default:return e}},pe=Object(te.c)({session:ue,portfolio:he}),me=[],de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_PORTFOLIO":return t.portfolio.data;default:return e}},fe={},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_SEARCH":return t.results.data.bestMatches;default:return e}},be=[],ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_PORTFOLIO":return t.portfolio.data;default:return e}},ye=[],ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_LATEST_PRICE":var n=Object(ce.merge)({},e);return n[t.payload.data.symbol]=t.payload.data.latestPrice,n;case"RECEIVE_LATEST_BATCH_PRICES":return t.payload.data;default:return e}},Se=Object(te.c)({search:Ee,portfolio:de,prices:ge,transactions:ve}),Oe=Object(te.c)({session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_CURRENT_USER":return Object(se.a)({},e,{isAuthenticated:!!t.currentUser,user:t.currentUser});case"RECEIVE_USER_LOGOUT":return{isAuthenticated:!1,user:void 0};case"RECEIVE_USER_SIGN_IN":return Object(se.a)({},e,{isSignedIn:!0});case"RECEIVE_NEW_BALANCE":var n=Object(ce.merge)({},e);return n.user.balance=t.accountBalance.data.balance,n;default:return e}},errors:pe,entities:Se}),ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(te.d)(Oe,e,Object(te.a)(ne.a,ae.a))};n(76);document.addEventListener("DOMContentLoaded",(function(){var e;if(localStorage.jwtToken){E(localStorage.jwtToken);var t=v()(localStorage.jwtToken);e=ke({session:{isAuthenticated:!0,user:t}});var n=Date.now()/1e3;t.exp<n&&(e.dispatch(O()),window.location.href="/login")}else e=ke({});var r=document.getElementById("root");c.a.render(a.a.createElement(ee,{store:e}),r)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.8227a64a.chunk.js.map